<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="tags: #notes #fleeting creation date: [[2022-09-22 Thursday]] 11:04:47 description:: multithreading
career fair on friday
project 2 due oct 3 asked to implement an algorithm in an existing codebase given two maze building algorithms, asked to implement another includes pdf describing terminology used graded on use of issue tracker develop your own junit tests &ldquo;big enough that you dont want to read all the files&rdquo; how do we interface with the rest of the code base without understanding it all?"><title>ü™¥ Quartz 3.3</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://carlomehegan.github.io/quartz-vault//icon.png><link href=https://carlomehegan.github.io/quartz-vault/styles.706bb6073ba85d26809f9096dae23a6b.min.css rel=stylesheet><link href=https://carlomehegan.github.io/quartz-vault/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://carlomehegan.github.io/quartz-vault/js/darkmode.d3b63235d6779582e069a9e8e0f62a2e.min.js></script>
<script src=https://carlomehegan.github.io/quartz-vault/js/util.5e39932758f9ecaf45fd54506ed61416.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://carlomehegan.github.io/quartz-vault/js/popover.6da9b273c092cc16fc1aa904d71a2163.min.js></script>
<script src=https://carlomehegan.github.io/quartz-vault/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://carlomehegan.github.io/quartz-vault/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://carlomehegan.github.io/quartz-vault/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://carlomehegan.github.io/quartz-vault/",fetchData=Promise.all([fetch("https://carlomehegan.github.io/quartz-vault/indices/linkIndex.0a3d211a6a91ce0bac4637f3dbf41d58.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://carlomehegan.github.io/quartz-vault/indices/contentIndex.079bd76a3aa9a07d0c43f9984abf6db9.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://carlomehegan.github.io/quartz-vault",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://carlomehegan.github.io/quartz-vault",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'‚Äô':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/carlomehegan.github.io\/quartz-vault\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://carlomehegan.github.io/quartz-vault/js/full-text-search.51f0b1753e9b30839d053f8a98cc20d1.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://carlomehegan.github.io/quartz-vault/>ü™¥ Quartz 3.3</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><p class=meta>Last updated
Dec 6, 2022
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/School%20Vault/Fleeting%20Notes/2022-09-22%20CSCI301.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#intro-to-multithreading---part-1>Intro to Multithreading - Part 1</a><ol><li></li></ol></li><li><a href=#intro-to-multithreading---part-2>Intro to Multithreading - Part 2</a><ol><li></li></ol></li></ol></nav></details></aside><p>tags: #notes #fleeting
creation date: <a class="internal-link broken">2022-09-22 Thursday</a> 11:04:47
description:: multithreading</p><p>career fair on friday</p><p>project 2
due oct 3
asked to implement an algorithm in an existing codebase
given two maze building algorithms, asked to implement another
includes pdf describing terminology used
graded on use of issue tracker
develop your own junit tests
&ldquo;big enough that you dont want to read all the files&rdquo;
how do we interface with the rest of the code base without understanding it all?
multithreading
in the project - shows a loading screen while maze is generating
talking about multithreading today</p><p><a class="internal-link broken">M2L3_MultiThreading_part1.key.pdf</a></p><a href=#intro-to-multithreading---part-1><h2 id=intro-to-multithreading---part-1><span class=hanchor arialabel=Anchor># </span>Intro to Multithreading - Part 1</h2></a><p>Multithreading allows us to program parallel applications within a single process, a single executing application</p><a href=#potential-benefits><h5 id=potential-benefits><span class=hanchor arialabel=Anchor># </span>potential benefits</h5></a><ul><li>speed up<ul><li>on a single processor architecture (with or without multiple cores)</li><li>on a multiprocessor architecture</li></ul></li><li>software design<ul><li>for certain types of application, multithreading gives better class design</li></ul></li><li>UI responsiveness<ul><li>gui remains responsive and interactive while heavy duty calculation lifted by background threads
also if you want to ex. back up a file every 20 seconds, this can be done using multithreading</li></ul></li></ul><a href=#what-are-threads><h5 id=what-are-threads><span class=hanchor arialabel=Anchor># </span>what are threads?</h5></a><ul><li>thread<ul><li>program unit that is executed independently</li><li>belongs to a particular process</li><li>multiple threads of a process can run simultaneously</li></ul></li><li>virtual machine, runtime environment<ul><li>executes thread for some time (eg a short time slice)</li><li>thread scheduler activates and deactivates threads</li><li>creates illusion of threads running in parallel<ul><li>actually switching really fast</li></ul></li></ul></li><li>multiprocessor / multicore architectures<ul><li>threads can actually run in parallel</li></ul></li></ul><a href=#declaring-and-running-threads><h5 id=declaring-and-running-threads><span class=hanchor arialabel=Anchor># </span>declaring and running threads</h5></a><ul><li>high level recipe<ul><li>define class that implements interface Runnable</li><li>Runnable has one method <code>void run()</code></li><li>place thread action into run method</li><li>construct object of runnable class</li><li>construct thread from that object</li><li>start thread</li></ul></li></ul><a href=#thread-ex><h5 id=thread-ex><span class=hanchor arialabel=Anchor># </span>thread ex.</h5></a><ul><li>run two threads in parallel</li><li>prints 10 greetings</li><li>after each print, sleep for 100 ms</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl> <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>i</span> <span class=o>+</span> <span class=s>&#34;: &#34;</span> <span class=o>+</span> <span class=n>greeting</span><span class=o>);</span>
</span></span><span class=line><span class=cl> <span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span><span class=n>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span> 
</span></span></code></pre></td></tr></table></div></div><p>all threads should occasionally <strong>yield</strong> control</p><ul><li>otherwise called selfish, could be cumbersome with scheduling</li><li>stimulates scheduler and thread switch<ul><li><code>yield()</code></li><li><code>sleep(long ms)</code> throws InterruptedException</li></ul></li></ul><a href=#ex-2-greeter-threads><h5 id=ex-2-greeter-threads><span class=hanchor arialabel=Anchor># </span>ex. 2 greeter threads</h5></a><p>1 thread printing Hello and 1 thread printing Goodbye
<a class="internal-link broken">Pasted image 20220922112926.png</a>
&ldquo;we use threads because we dont want to enforce what comes first, second, etc&rdquo;
&ldquo;if you want that control just code like normal&rdquo;</p><a href=#life-cycle-of-a-thread-in-java><h5 id=life-cycle-of-a-thread-in-java><span class=hanchor arialabel=Anchor># </span>life cycle of a thread in Java</h5></a><p><a class="internal-link broken">Pasted image 20220922113248.png</a></p><a href=#states-of-a-thread-that-isalive><h5 id=states-of-a-thread-that-isalive><span class=hanchor arialabel=Anchor># </span>states of a thread that isAlive()</h5></a><p>different states between start() and termination
<a class="internal-link broken">Pasted image 20220922113312.png</a>
if sleeping or waiting, moved to Blocked state
moves to Runnable when sleep is over or done waiting
this is Thread Scheduling as Java VM sees it, more going on underneath</p><a href=#blocked-thread-state><h5 id=blocked-thread-state><span class=hanchor arialabel=Anchor># </span>blocked thread state</h5></a><ul><li>reasons for blocked state<ul><li>sleeping</li><li>waiting to acquire lock</li><li>waiting for condition</li></ul></li><li>unblocks only if reason block goes away</li></ul><a href=#scheduling-threads><h5 id=scheduling-threads><span class=hanchor arialabel=Anchor># </span>scheduling threads</h5></a><ul><li>scheduler activates new thread if<ul><li>a thread has completed its time slice</li><li>a thread has blocked itself</li><li>a thread with higher priority has become runnable</li></ul></li><li>scheduler determines new thread to run<ul><li>looks only at runnable threads</li><li>picks one with max priorities<ul><li>priority is platform dependent</li><li>dont mess with (for now)</li></ul></li></ul></li></ul><a href=#terminating-threads><h5 id=terminating-threads><span class=hanchor arialabel=Anchor># </span>terminating threads</h5></a><p>a natural death:</p><ul><li>thread terminates when run exits</li><li>other thread may wait for it<ul><li>option 1 <code>dyingThread.join()</code></li><li>option 2 <code>while (dyingThread.isAlive()) { Thread.sleep(1000); }</code></li></ul></li></ul><p>ways to kill a thread</p><ol><li>murder: premature approach of early java versions
like closing a window on your laptop
stop method: (deprecated)
do not use this method, leaves computation in uncontrolled/unclear state</li><li>request for suicide:
we request the thread to terminate itself
interrupt method<ul><li>calling t.interrupt() doesnt actually interrupt t; just sets a flag</li><li>effect depends on thread program code</li><li>supposed behavior<ul><li>interrupted thread must sense interruption <code>boolean isInterrupted()</code></li><li>and exit its run method</li></ul></li><li>interrupted thread has a chance to clean up</li></ul></li></ol><a href=#sensing-interruptions><h5 id=sensing-interruptions><span class=hanchor arialabel=Anchor># </span>sensing interruptions</h5></a><p>option 1</p><ul><li>thread could occasionally call <code>Thread.currentThread().isInterrupted()</code></li></ul><p>option 2</p><ul><li>thread could occasionally <code>sleep()</code>, or <code>wait()</code></li><li>both methods throw InterruptedException when thread interrupted</li><li>&mldr; and then the interruption status is cleared</li></ul><p>option 2 is more robust</p><ul><li>sleep occasionally, catch exception and react to interruption</li><li><strong>allows for clear separation of code</strong></li></ul><p>recommendation</p><ul><li>terminate run when sensing interruption (common reaction)</li><li>use variant 2<ul><li>locate all code for cleaning up in <code>catch/finally</code> clause</li><li>enhance with variant 1 for lengthy methods without exceptions</li><li>make check with <code>isInterrupted throw InterruptedException</code></li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyRunnable</span> <span class=kd>implements</span> <span class=n>Runnable</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span>
</span></span><span class=line><span class=cl>	<span class=o>{</span>
</span></span><span class=line><span class=cl>		<span class=k>try</span>
</span></span><span class=line><span class=cl>		<span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=k>while</span> <span class=o>(...)</span>
</span></span><span class=line><span class=cl>			<span class=o>{</span>
</span></span><span class=line><span class=cl>				<span class=c1>// do work
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(...);</span>
</span></span><span class=line><span class=cl>			<span class=o>}</span>
</span></span><span class=line><span class=cl>		<span class=o>}</span>
</span></span><span class=line><span class=cl>		<span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span>
</span></span><span class=line><span class=cl>		<span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=c1>// clean up
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=o>}</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>üèÉ‚Äç‚ôÇÔ∏è, üò¥, ‚è∞</p><a href=#summary><h5 id=summary><span class=hanchor arialabel=Anchor># </span>summary</h5></a><p>create threads
assign work to a thread
terminate a thread
next:
communicate data between threads
race condition
locks and synchronized method calls</p><p><a class="internal-link broken">M2L3_MultiThreading_part2.key.pdf</a></p><a href=#intro-to-multithreading---part-2><h2 id=intro-to-multithreading---part-2><span class=hanchor arialabel=Anchor># </span>Intro to Multithreading - Part 2</h2></a><p>theres example stuff im not gonna write it all out</p><p>typical situation in compositional approaches</p><ul><li>1st step: get the components<ul><li>define threads, get them running, make them terminate</li></ul></li><li>2nd step: combine components to overall system
Here: communication among threads?<ul><li>in principle: simple, threads communicate via shared memory, ie objects</li><li>eg. explicitly via an object &ldquo;messageQueue&rdquo;</li><li>eg. implicitly via object that hold data and are accessed by several threads (not necessarily aware of one another)</li><li>in practice: <strong>shared data must be handled with care!</strong></li></ul></li></ul><p>example: visitors to a garden counted at 2 turnstiles
threads A and B: read counter, increment value, update counter, do 20 times</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>0</span> <span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>20</span> <span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=n>x</span> <span class=o>=</span> <span class=n>counter</span> <span class=o>;</span> <span class=n>x</span><span class=o>++</span> <span class=o>;</span> <span class=n>counter</span> <span class=o>=</span> <span class=n>x</span> <span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>both threads communicate via shared counter
expect result of counter = 40
does it work</p><ul><li>often, but there is no quarantee</li><li>occasionally see results like 32, 37, 39&mldr;</li></ul><a href=#race-condition><h5 id=race-condition><span class=hanchor arialabel=Anchor># </span>race condition</h5></a><p>A race condition occurs if <strong>the effect of multiple threads on shared data depends on the order in which threads are scheduled</strong>.</p><ul><li>obviously a bad thing<ul><li>common requirement - we want deterministic programs that reliably produce same correct output for same input</li><li>additional difficulty - detection of race condition, may be difficult to reproduce</li><li>essentially a nightmare for debugging and testing</li></ul></li><li>so we need<ul><li>a design strategy to avoid race conditions.</li><li>a technical, language mean that helps us programming a solution<ul><li>(what does that mean am i having a stroke)</li></ul></li></ul></li></ul><a href=#solution-to-race-conditions><h5 id=solution-to-race-conditions><span class=hanchor arialabel=Anchor># </span>solution to race conditions</h5></a><ul><li>access to shared objects requires protection<ul><li>mutual exclusion:<ul><li>thread/process can access object or enter a critical code section <strong>only one at a time</strong></li><li>generalization; at most $n$ threads/processes, common: $n$ reader, 1 writer</li></ul></li></ul></li><li>key issue<ul><li>thread can do that computation without being disturbed, without interference from others</li></ul></li><li>design strategy<ul><li>check all classes, objects with read/write access to several threads</li><li>use encapsulation and restrict access</li></ul></li><li>in java<ul><li>synchronize access to shared objects to have at most $n$ threads access data</li><li>means to describe that: <strong>Locks</strong></li><li>important - concept should avoid busy waiting (which is the case here)!</li></ul></li></ul><a href=#object-locks><h5 id=object-locks><span class=hanchor arialabel=Anchor># </span>object locks</h5></a><ul><li>each object in Java has a lock</li><li>lock activated with keyword &ldquo;<code>synchronized</code>&rdquo;</li><li>calling a synchronized method - acquires lock of implicit parameter</li><li>leaving the synchronized method - releases lock</li><li>easier than explicit Lock objects - but granularity fixed to method calls!</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kd>synchronized</span> <span class=kt>void</span> <span class=nf>add</span><span class=o>(</span><span class=n>E</span> <span class=n>newValue</span><span class=o>)</span> <span class=o>{</span> <span class=o>.</span> <span class=o>.</span> <span class=o>.</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kd>synchronized</span> <span class=n>E</span> <span class=nf>remove</span><span class=o>()</span> <span class=o>{</span> <span class=o>.</span> <span class=o>.</span> <span class=o>.</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>	<span class=o>.</span> <span class=o>.</span> <span class=o>.</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#summary-1><h5 id=summary-1><span class=hanchor arialabel=Anchor># </span>summary</h5></a><p>create threads
assign work to a thread
terminate a thread
communicate data between threads
shared memory, shared objects
race condition
locks and synchronized method calls</p><a href=#challenges-in-testing-a-multithreaded-class><h5 id=challenges-in-testing-a-multithreaded-class><span class=hanchor arialabel=Anchor># </span>challenges in testing a multithreaded class</h5></a><p>see last slide i dont wanna write it out</p><a href=#for-project-2><h5 id=for-project-2><span class=hanchor arialabel=Anchor># </span>for project 2</h5></a><p>asked to test code that runs in background thread
typically with testing create object, perform operations, see if it checks out
background threads complicate this, test is running faster than background thread</p><ul><li>our maze building algorithm operates on a background thread</li><li>test code executes on a different thread
have to use order() to order a maze
we have method waitTillDelivered() for waiting during testing
uhh idk im not following anymore look at MazeFactory.java for fully implemented class
&ldquo;challenge is to implement a not so easy algorithm, making it fit in isnt as hard&rdquo; (we can see the other two algorithms already implemented)
&ldquo;challenge is to write meaningful tests cases&rdquo;</li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://carlomehegan.github.io/quartz-vault/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Jacky Zhao using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, ¬© 2022</p><ul><li><a href=https://carlomehegan.github.io/quartz-vault/>Home</a></li><li><a href=https://twitter.com/_jzhao>Twitter</a></li><li><a href=https://github.com/jackyzha0>Github</a></li></ul></footer></div></div></body></html>